<html>

	<head>
		<meta charset="utf-8">
		<script src="https://cdn.jsdelivr.net/npm/brython@3.9.0/brython.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/brython@3.9.0/brython_stdlib.js"></script>
		<style>
			body {
				background: #222;
				font-size: 5vmin;
				color: #fff;
			}
			gray  { color: #444; }
			white { color: #fff; }
		</style>
	</head>

	<body onload="brython()">

		<code id="code">
			Loading python engine... (~20s) (1 reload may be required)
		</code>

<script type="text/python">

TEXT = "ESKISTAFÜNFZEHNZWANZIGDREIVIERTELVORFUNKNACHHALBAELFÜNFEINSXAMZWEIDREIPMJVIERSECHSNLACHTSIEBENZWÖLFZEHNEUNKUHR"
#       0    5   10   15   20   25   30   35   40   45   50   55   60   65   70   75   80   85   90   95  100  105  110

WORDS = {
	'ES':           (0, 2),
	'IST':          (3, 3),
	'FÜNF_PRE':     (7, 4),
	'FÜNFZEHN':     (7, 8),
	'ZEHN_PRE':     (11, 4),
	'ZWANZIG':      (15, 7),
	'DREIVIERTEL':  (22, 11),
	'VIERTEL':      (26, 7),
	'VOR':          (33, 3),
	'NACH':         (40, 4),
	'HALB':         (44, 4),
	'ELF':          (49, 3),
	'FÜNF_UHR':     (51, 4),
	'EINS':         (55, 4),
	'ZWEI':         (62, 4),
	'DREI':         (66, 4),
	'VIER':         (73, 4),
	'SECHS':        (77, 5),
	'ACHT':         (84, 4),
	'SIEBEN':       (88, 6),
	'ZWÖLF':        (94, 5),
	'ZEHN_UHR':     (99, 4),
	'NEUN':         (102, 4),
	'UHR':          (107, 3),
}

HOURS = ['ZWÖLF', 'EINS', 'ZWEI', 'DREI', 'VIER', 'FÜNF_UHR', 'SECHS', 'SIEBEN', 'ACHT', 'NEUN', 'ZEHN_UHR', 'ELF' ]
PARTS = [['UHR'], ['FÜNF_PRE'], ['ZEHN_PRE'], ['VIERTEL'], ['ZWANZIG'], ['FÜNF_PRE', 'HALB'], ['HALB']]

active = [False] * len(TEXT)

def set(word, val=True):
	idx, len = word
	active[idx:idx+len] = [val for _ in range(len)]

def reset():
	global active
	set((0, len(TEXT)), False)
	set(WORDS['ES'])
	set(WORDS['IST'])

reset()

def settime(time):
	reset()

	hour = time.hour % 12
	minute = 5 * round((time.minute + time.second/60) / 5)
	before = False

	if minute >= 25:
		hour = (hour + 1) % 12
		before = True
		minute = (60-minute)
		if minute == 35:
			minute = 25
			before = False

	print(minute, 'vor' if before else 'nach', hour)

	# 25 before 6 -> 5 after  half 6
	# 25 after  6 -> 5 before half 6
	if minute == 25:
		before = not before

	if not minute in [0, 30]:
		set(WORDS['VOR' if before else 'NACH'])

	set(WORDS[HOURS[hour]])

	for part in PARTS[minute//5]:
		set(WORDS[part])


def dump():
	COLS = 11
	RESET = '</gray>'
	WHITE = '</gray><white>'
	GRAY = '</white><gray>'

	result = GRAY

	for i, char in enumerate(TEXT):
		col = i % COLS
		row = i // COLS
		if (col == 0):
			result += '<br>&nbsp;&nbsp;'
		color = (WHITE if active[i] else GRAY) if i==0 or active[i] != active[i-1] else ''
		result += f' {color}{char} '
	result += RESET + '<br>'

	return result

import time
from datetime import datetime
from browser import document, html, timer

def update():
	now = datetime.now()
	print(now)

	settime(now)
	document['code'].html = dump()

timer.set_interval(update, 10 * 1000)

</script>


	</body>

</html>
